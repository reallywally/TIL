# ORA-00054: 리소스가 사용 중입니다

## 상황

인텔리제이로 오라클 DB를 연결하고 데이터를 수정하였다. 그런데 인텔리제이에서는 데이터가 잘 보이는데 실제 쿼리로는 조회값이 없는 기이한 현상이 발생하였다. 어차피 테스트로 만든 테이블이라 drop 할려니 "[61000][54] ORA-00054: 리소스가 사용 중이어서 NOWAIT가 지정되었거나 시간 초과가 만료된 상태로 획득합니다." 라는 에러 메시지가 떳다.

## 발생 원인

결론은 데이터를 수정하면서 인텔리제이를 주인으로 Lock이 걸려 버려서 다른 사용자로는 조회가 안되는 것이다. 현재 누가에 의해 Lock이 걸렸는지는 아래 쿼리로 확인해 볼 수 있다.

```sql
SELECT
    s.sid,
    s.serial#,
    s.username,
    s.osuser,
    s.program,
    o.object_name,
    o.object_type
FROM
    v$session s
JOIN
    v$locked_object l ON s.sid = l.session_id
JOIN
    dba_objects o ON l.object_id = o.object_id;
```

## 해결 방법

### 1. 기다리기

해결방법이라 하긴 좀 민망하지만 가장 확실한? 방법이다. Lock은 영하지 않다. 시간이 급하지 않다면 잠시 명상과 기도를 하고 오자.

### 2. 세션 강제 종료

만약 어떤 사유로 Lock이 오랬동안 유지 된다면 강제 종료할 수 있다. 대신 강제 종료인 만큼 일반 사용자는 못하고 관리자(DBA) 권한이 필요하다.

## 예방 