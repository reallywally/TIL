# chapter2 에이전트 시스템 설계

## 에이전트 작업 범위

- 에이전트의 작업 범위를 설정할때는 늘 균형을 신경써야한다.
- 만약 범위를 너무 좁게 설정하여 주문 취소만 하는 에이전트면 환불, 배송지 변경 등 다른 요청을 처리하지 못한다.
- 반대로 너무 넓게 설정하여 가격 문의, 상품 추천 등 모든 문의를 대응할려면 복잡하고 작업 시간이 오래 걸리다.

## 에이전트 시스템의 핵심 구성요소

효과적인 에이전트 시스템을 설계하려면 에이전트가 임무를 잘 수행하도록 돕는 **핵심 구성요소**를 깊이 이해해야한다.

### 모델

- 정확도가 중요하다면 속도가 느리더라도 대형 모델을 쓰는게 좋다.
- 실시간 응답성이 중요하다면 작은 모델이 더 실용적일 수 있다.
- 실제로는 상황에 따라 모델을 선택해서 사용하는 **하이브리드 방식**을 많이 사용한다.
- 테스트를 거처서 가장 가성비 좋은 모델을 선택한다.
- 한번 모델을 선택하고 끝이 아니라 상황에 변경됨에 따라 지속적으로 **재검토**해야 한다.

### 도구

- 에이전트의 효과는 도구의 범위와 정교함에 달려 있다.
- 도구 개발은 반드시 **모듈형**으로 개발해야하다.

### 메모리

- 메모리는 에이전트가 정보를 저장하고 검색할 수 있게 하는 핵심 구성 요소이다.
- 단기 메모리: 고객지원과 같이 현재 작업, 대화 관련 정보를 관리
- 장기 메모리: 추천 처럼 과거 정보를 바탕으로  향후 행동을 결정할 수 있게

### 오케스트레이션

- 여러 에이전트, 도구, 모델의 역할과 실행 순서를 조율해 하나의 목표를 달성하도록 제어하는 과정이다.
- 예를들어 교통 상황, 시간 제역, 차량 가용성을 고려하여 최적의 배송 경로 파악

## 설계 트레이드 오프

성능, 확장성, 신뢰성, 비용 사이의 다양한 트레이프 오프를 균형있게 조정해야 한다.

### 성능

- 자율주행은 정확도 보단 속도가 중요하고 법률, 의료 진단은 속도 보다 정확도가 중요하다.
- 상황에 따라 속도와 정확도의 균형을 잘 정해야 한다.
- 하이브리드도 많이 쓰인다.

### 확장성

- 시스템이 커질수록 데이터량, 동시 처리 작업 수, 연산 리소스(GPU) 효율 관리가 핵심
- 동적 GPU 할당, 우선순위 큐잉, 비동기, 로드 밸런싱, 수평 확장 등 방법이 있다.

### 신뢰성

- 에이전트가 일관되고 정확하게 작업을 수행할 수 있는 능력이다.
- 일반 서버와 마찬가지로 이중화가 중요하다.
- 철저한 테스트와 지속적인 모니터링, 피드백

### 비용

- 자주 간과하지만 개발, 배포, 유지하는데 드는 비용과 ROI를 기준으로 평가해야한다.
- 중요도가 낮고 단순한 저비용으로하고, 중요하고 복잡한건 투자를 해야 한다.
- 결국 애이전트 시스템의 비용은 그 가지로 정당화되어야 한다.

## 아키텍처 디자인 패턴

### 단일 에이전트 아키텍처

- 다른 에이전트 도움 없이 스스로 의사결정, 계획 수립, 실행을 수행한다.
- 협업이나 분산 처리가 필요하지 않은 좁은 범위 업무에 유용하다
- 예를들어 고객 문의(FAQ, 주문조회 등), 간단한 챗봇

### 멀티 에이전트 아키텍처

- 여러 에이전트가 공동의 목표를 달성하기 위해 협력한다.
- 장점: 협업과 전문호, 병렬성, 확장성, 중복성과 복원력
- 단점: 통신의 복잡성, 토큰 효율성 저하

## 다양한 모범 사례

### 점진적 설계

- 초기부터 완벽한 결과물을 목표로 하기보다 작동하는 작은 프로토타입을 만들고 피드백을 반영해 여러 차례에 걸쳐 개선한다

### 평가 전략

- 학습에 사용된 특정 시나리오를 넘어 일반화할 수 있는 능력을 반드시 평가해야 한다.
- 재학습 없이도 새로운 작업에 적응하는 능력을 검증해야한다.
- 평가는 실제 적용 환경에 최대한 비슷한 환경에서 수행해야 한다.

### 실환경 테스트

- 배포하고 실제 환경에서도 반드시 테스트, 모니터링이 필요하다.
- 예측 불가능성과 복잡성을 처리할 수 있도록 보장해야한다.

## 내 생각

- 에이전트 아키텍처는 일반 웹 어플리케이션의 모노레포와 MSA를 비교하는것과 비슷한거 같고 모범 사례 또한 웹 어플리케이션 개발의 모험 사례와 다르지 않다.
- 에이전트 또한 다른 웹 어플리케이션이라 생각하고 접근하면 익숙한 부분이 많을거 같다.
