# Retriever(검색기)를 알아보자

## Retriever란

벡터 DB에서 사용자 질문과 련된 문서를 검색하는 과정이다. 가장 관련성 높은 정보를 잘 찾아오는게 가장 중요하며 RAG 시스템의 전반적인 효율성과 사용자 만족도에 직접적인 영향을 미치기 때문에 매우 중요한 부분이다.

## 동작 방식

1. 질문 벡터화: 사용자 질문을 벡터 DB에서 검색이 가능하도록 벡터화 한다.
2. 벡터 유사성 비교: 코사인 유사성, MMR 등 수학적 방법을 통해 유사성을 계산한다.
3. 상위 문서 선정: 유사성 점수를 기준으로 가장 관련성 높은 상위 N개의 문서를 선정한다.
4. 문서 정보 반환: 선정된 문서를 다음 단계(프롬프트 생성)으로 전달한다.

## Sparse Retriever와 Dense Retriever

검색 방법과 목적에 따라 방법을 잘 선택해야한다. 핵심만 정리하면 Sparse Retriever는 키워드 검색, Dense Retriever는 의미적 표현 검색에 적합하다. 그래서 법률 문서, 기술 문서와 같이 정확한 키워드 검색이 필요한 상황에서는 Sparse Retriever를 선택하고 상담, 챗봇, RAG와 같이 유사성이 중요한 상황에서는 Dense Retriever를 선택한다.

## Hybrid Retrieval

실제 프로덕션 환경에서는 Sparse와 Dense의 장점을 결합한 Hybrid Retriever를 많이 사용한다.
